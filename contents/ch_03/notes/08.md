[Back to main](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study#readme)

# 3.8 Array Allocation and Access

## 3.8.1 Basic Principles
### Ex.) Arrays in C
* Declaration
  ```c
  char A[12];
  char *B[8];
  double C[6];
  double *D[5];
  ```
* Size
  ![](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/images/03_08_01_array_size.png)
* Notation
  * For *T* = A[*N*], L : the size of T, and ![](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/images/03_08_01_x_a.png) : the location of the array A
  * the i-th element's element can be denoted as ![](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/images/03_08_01_ith_address.png)


### In IA32 assembly
* For an array of integers E
  * Suppose the address of E is stored at %edx.
  * And the address of an integer i is stored at %ecx
* The value at E[i] can be denoted in assembly as
  ```assembly
  movl (%edx, %ecx, 4), %eax
  ```

[:orange_book: Practice Problem 3.35](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/problems/practice_problems.md#practice-problem-335)


## 3.8.2 Pointer Arithmetic

### Tech.) Dealing with array in assembly
* mov instruction : reference the memory (the value)
* leal instruction : generate the address of an element
* ex.)
  ![](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/images/03_08_02_mov_leal.png)

[:orange_book: Practice Problem 3.36](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/problems/practice_problems.md#practice-problem-336)

---

## 3.8.3 Nested Arrays
* For
  ```c
  T D[R][C]
  ```
  * Where
    * T : a datatype
    * D : a nested array (2-dimension)
    * R : the size of D
    * C : the size of D[i]
* the address of the (i, j)-th element as follows can be denoted as...
  ```c
  D[i][j]
  ```
  * ![](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/images/03_08_03_nested_array_def.png)
    * Where
      * L : the size of datatype T
      * ![](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/images/03_08_03_x_d.png) : the address of the array D


#### Ex.) Nested Array Example
* Suppose X_A, i, and j are at offsets 8, 12, 16 relative to %ebp respectively.
* Then array element A[i][j] can be copied to register %eax by the following code:
  ```assembly
  movl  12(%ebp), %eax          Get i
  leal  (%eax, %eax, 2), %eax   Compute 3*i
  movl  16(%ebp), %edx          Get j
  sall  $2, %edx                Compute 4*j
  addl  4(%ebp), %edx           Compute X_A + 4*j
  movl  (%edx, %eax, 4), %eax   Compute X_A + 4*j + 12*i : Read from M[X_A + 4*j + 12*i]
  ```

[:orange_book: Practice Problem 3.37](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study/blob/main/contents/ch_03/problems/practice_problems.md#practice-problem-337)




### KEYWORDS
* array; nested array; 


[Back to main](https://github.com/JoonHyeok-hozy-Kim/computer_systems_study#readme)